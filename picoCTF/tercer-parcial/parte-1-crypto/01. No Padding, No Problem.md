## Objetivo
Oracles can be your best friend, they will decrypt anything, except the flag's ciphertext. How will you break it? Connect with `nc mercury.picoctf.net 42248`.

## Pistas
## Solución
1. Ir a la consola de Linux y escribir lo siguiente:
```
kali@kali:~$ nc mercury.picoctf.net 42248
Welcome to the Padding Oracle Challenge
This oracle will take anything you give it and decrypt using RSA. It will not accept the ciphertext with the secret message... Good Luck!


n: 122942624504942065133581913139517532361338791940295932464640977205933807909294444060216852599576339275838630168771791952272091781407085130730178335655263580174077326098272481006365692772324577770839897927198249395229342698780728047730564999651600081354036838893151633497639403661609607429392173829504675650297
e: 65537
ciphertext: 29487791069295222330394628343445518340706953821447139461534014280298194047712351836512844662408350726918240174290236387556152192184781513006426117125876864943054686687679369093267592293855617985436268414820062145184180837715975818889527701096997972088389964186485718548183778032289235157657852681834320429309


Give me ciphertext to decrypt: 29487791069295222330394628343445518340706953821447139461534014280298194047712351836512844662408350726918240174290236387556152192184781513006426117125876864943054686687679369093267592293855617985436268414820062145184180837715975818889527701096997972088389964186485718548183778032289235157657852681834320429309
Will not decrypt the ciphertext. Try Again
Give me ciphertext to decrypt:
```
2. Al ingresar el texto cifrado indica que no se puede decodificar, entonces usamos la propiedad homomórfica de unpadded RSA:
```
encrypt(m1) * encrypt(m2) = (m1^e * m2^e) mod n = (m1 * m2)^e mod n = encrypt(m1 * m2)
```
3. Se muestra que la multiplicación de dos encriptaciones de textos diferentes es igual a la encriptación de la multiplicación de dos textos plano, entonces encriptamos un número cualquiera, en este caso 10:
```
m = 10
e = 65537
n = 122942624504942065133581913139517532361338791940295932464640977205933807909294444060216852599576339275838630168771791952272091781407085130730178335655263580174077326098272481006365692772324577770839897927198249395229342698780728047730564999651600081354036838893151633497639403661609607429392173829504675650297
c = pow(m,e,n)
print(c)

33619248994060226886711913299921684869301824011743361401678301321160093600559046235679136304008961341551865895985482738310047764083169455553421567634717373100509221913997887006059497040758028601635870229356130795031161234521709139195780241548455904806754679609254776906887941650969137656897576179335248826661
```
4. Ahora multiplicamos ambos textos cifrados:
```
a = 33619248994060226886711913299921684869301824011743361401678301321160093600559046235679136304008961341551865895985482738310047764083169455553421567634717373100509221913997887006059497040758028601635870229356130795031161234521709139195780241548455904806754679609254776906887941650969137656897576179335248826661
b = 29487791069295222330394628343445518340706953821447139461534014280298194047712351836512844662408350726918240174290236387556152192184781513006426117125876864943054686687679369093267592293855617985436268414820062145184180837715975818889527701096997972088389964186485718548183778032289235157657852681834320429309
c = a *b
print(c)

991357390243461545472240956661565110777746436740569466213861301714828687034571425809023682100419567098861276921555483821676116966599846633924629496012987827614060581246896115286231648523172419471332636521835409221283196717954242074234383311578883056585905266130989098170542097976592821575817299617576230020354707451694541871617514670068445421286556503939675589475111254002562635612163063130077802508605734641842179323516024112842696778781289371137784836774129300501048532012212852320515016411034905784646845666224695238811043732660948574778666887147837025548355756581558338211600358955094462182559903437144045007249
```
5. El producto lo tratamos de decodificar con la herramienta:
```
Give me ciphertext to decrypt: 991357390243461545472240956661565110777746436740569466213861301714828687034571425809023682100419567098861276921555483821676116966599846633924629496012987827614060581246896115286231648523172419471332636521835409221283196717954242074234383311578883056585905266130989098170542097976592821575817299617576230020354707451694541871617514670068445421286556503939675589475111254002562635612163063130077802508605734641842179323516024112842696778781289371137784836774129300501048532012212852320515016411034905784646845666224695238811043732660948574778666887147837025548355756581558338211600358955094462182559903437144045007249
Here you go: 2902750301958500394734566183674558850699657488512780767567437204467033145174013592673227690374692514453848581343969386297570
Give me ciphertext to decrypt: 

```
6. El valor que nos regresa `2902750301958500394734566183674558850699657488512780767567437204467033145174013592673227690374692514453848581343969386297570` lo dividimos entre 10 para obtener el resultado:
```
2902750301958500394734566183674558850699657488512780767567437204467033145174013592673227690374692514453848581343969386297570 / 10 = 290275030195850039473456618367455885069965748851278076756743720446703314517401359267322769037469251445384858134396938629757
```
7. Obtenemos la bandera por medio de Python:
```
m = 290275030195850039473456618367455885069965748851278076756743720446703314517401359267322769037469251445384858134396938629757
print(bytes.fromhex(hex(m)[2:]).decode())

picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_7416022}
```
8. La bandera es :
picoCTF{m4yb3_Th0se_m3s54g3s_4r3_difurrent_7416022}}
## Notas adicionales
## Referencias
https://en.wikipedia.org/wiki/Homomorphic_encryption